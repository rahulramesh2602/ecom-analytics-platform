{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-12-15T10:58:28.700953Z", "invocation_id": "b77f89bc-13b6-4a8e-b548-becba3df70f1", "invocation_started_at": "2025-12-15T10:58:26.283559Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-15T10:58:27.067841Z", "completed_at": "2025-12-15T10:58:27.076418Z"}, {"name": "execute", "started_at": "2025-12-15T10:58:27.076680Z", "completed_at": "2025-12-15T10:58:28.687137Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6200799942016602, "adapter_response": {"_message": "SELECT 32951", "code": "SELECT", "rows_affected": 32951}, "message": "SELECT 32951", "failures": null, "unique_id": "model.ecom_analytics.mart_individual_products", "compiled": true, "compiled_code": "-- Product-level performance mart\n-- One row per product_id with detailed product metrics\nWITH product_metrics AS (\n    SELECT \n        p.product_id,\n        oj.product_category_name_english,\n        p.product_name_lenght,\n        p.product_description_lenght,\n        p.product_photos_qty,\n        p.product_weight_g,\n        p.product_length_cm,\n        p.product_height_cm,\n        p.product_width_cm,\n        \n        -- Order metrics\n        COUNT(DISTINCT oj.order_id) as total_orders,\n        COUNT(DISTINCT oj.customer_id) as unique_customers,\n        COUNT(oj.order_item_id) as total_quantity_sold,\n        \n        -- Revenue metrics  \n        SUM(oj.total_item_value) as total_product_revenue,\n        AVG(oj.price) as average_selling_price,\n        AVG(oj.total_item_value) as average_order_value,\n        \n        -- Delivery metrics\n        AVG(oj.delivery_days) as average_delivery_days,\n        COUNT(CASE WHEN oj.is_late_delivery THEN 1 END) * 100.0 / COUNT(oj.order_id) as late_delivery_percentage,\n        \n        -- Time analysis\n        MIN(oj.order_purchase_timestamp) as first_order_date,\n        MAX(oj.order_purchase_timestamp) as last_order_date,\n        \n        -- Customer behavior\n        AVG(oj.total_item_value) as average_item_value\n        \n    FROM \"ecommerce_db\".\"analytics\".\"stg_products\" p\n    LEFT JOIN \"ecommerce_db\".\"analytics\".\"int_orders_joined\" oj \n        ON p.product_id = oj.product_id\n    GROUP BY \n        p.product_id,\n        oj.product_category_name_english,\n        p.product_name_lenght,\n        p.product_description_lenght,\n        p.product_photos_qty,\n        p.product_weight_g,\n        p.product_length_cm,\n        p.product_height_cm,\n        p.product_width_cm\n),\n\nproduct_rankings AS (\n    SELECT \n        *,\n        -- Revenue rankings\n        ROW_NUMBER() OVER (ORDER BY total_product_revenue DESC NULLS LAST) as revenue_rank,\n        ROW_NUMBER() OVER (PARTITION BY product_category_name_english ORDER BY total_product_revenue DESC NULLS LAST) as category_revenue_rank,\n        \n        -- Volume rankings\n        ROW_NUMBER() OVER (ORDER BY total_quantity_sold DESC NULLS LAST) as volume_rank,\n        ROW_NUMBER() OVER (PARTITION BY product_category_name_english ORDER BY total_quantity_sold DESC NULLS LAST) as category_volume_rank,\n        \n        -- Performance tiers\n        CASE \n            WHEN total_product_revenue >= 50000 THEN 'Star Product'\n            WHEN total_product_revenue >= 10000 THEN 'Strong Performer'  \n            WHEN total_product_revenue >= 1000 THEN 'Average Performer'\n            WHEN total_product_revenue > 0 THEN 'Low Performer'\n            ELSE 'No Sales'\n        END as performance_tier\n        \n    FROM product_metrics\n)\n\nSELECT \n    product_id,\n    product_category_name_english,\n    \n    -- Product attributes\n    product_name_lenght,\n    product_description_lenght,\n    product_photos_qty,\n    product_weight_g,\n    product_length_cm,\n    product_height_cm,\n    product_width_cm,\n    \n    -- Sales metrics\n    total_orders,\n    unique_customers,\n    total_quantity_sold,\n    \n    -- Revenue metrics\n    ROUND(total_product_revenue::NUMERIC, 2) as total_product_revenue,\n    ROUND(average_selling_price::NUMERIC, 2) as average_selling_price,\n    ROUND(average_order_value::NUMERIC, 2) as average_order_value,\n    \n    -- Delivery metrics\n    ROUND(average_delivery_days::NUMERIC, 1) as average_delivery_days,\n    ROUND(late_delivery_percentage::NUMERIC, 2) as late_delivery_percentage,\n    \n    -- Time metrics\n    first_order_date,\n    last_order_date,\n    ROUND(average_item_value::NUMERIC, 2) as average_item_value,\n    \n    -- Rankings\n    revenue_rank,\n    category_revenue_rank,\n    volume_rank,\n    category_volume_rank,\n    \n    -- Performance tier\n    performance_tier\n    \nFROM product_rankings\nORDER BY revenue_rank", "relation_name": "\"ecommerce_db\".\"analytics\".\"mart_individual_products\"", "batch_results": null}], "elapsed_time": 1.793233871459961, "args": {"defer": false, "strict_mode": false, "favor_state": false, "quiet": false, "select": ["mart_individual_products"], "state_modified_compare_vars": false, "show_all_deprecations": false, "introspect": true, "print": true, "exclude": [], "log_path": "/Users/raramesh/Desktop/Project/ecom-analytics-platform/ecom_analytics/logs", "upload_to_artifacts_ingest_api": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "skip_nodes_if_on_run_start_fails": false, "state_modified_compare_more_unrendered_values": false, "require_nested_cumulative_type_params": false, "require_explicit_package_overrides_for_builtin_materializations": true, "empty": false, "show_resource_report": false, "profiles_dir": "/Users/raramesh/.dbt", "validate_macro_args": false, "macro_debugging": false, "version_check": true, "printer_width": 80, "use_fast_test_edges": false, "indirect_selection": "eager", "project_dir": "/Users/raramesh/Desktop/Project/ecom-analytics-platform/ecom_analytics", "log_format": "default", "require_yaml_configuration_for_mf_time_spines": false, "populate_cache": true, "require_generic_test_arguments_property": true, "use_colors": true, "cache_selected_only": false, "partial_parse": true, "use_colors_file": true, "partial_parse_file_diff": true, "invocation_command": "dbt run --select mart_individual_products", "source_freshness_run_project_hooks": true, "write_json": true, "require_batched_execution_for_custom_microbatch_strategy": false, "log_file_max_bytes": 10485760, "require_all_warnings_handled_by_warn_error": false, "which": "run", "log_level_file": "debug", "static_parser": true, "log_level": "info", "require_resource_names_without_spaces": true, "log_format_file": "debug", "send_anonymous_usage_stats": true, "vars": {}}}